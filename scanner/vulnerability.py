"""
File: vulnerability.py
Assignment: Mini Project 2
Lanuguage: python3
Author: Sean Kells <spk3077@rit.edu>
Purpose: House vulnerabilities in a vulnerability object
"""
class Vulnerability:
    def __init__(self, source, url, payload, tag=None):
        """
        __init__ is constructor for vulnerability object

        :param self: this object
        :param source: DOM XSS Source
        :param url: URL vulnerability is located on
        :param payload: exploit string utilized
        :param tag: element object
        :return: Nothing
        """
        self.source = source
        self.url = url
        self.payload = payload

        self.tag = tag
        if self.tag != None:
            self.tag_element = tag.tag_name
            self.tag_id = tag.get_attribute("id")
            self.tag_name = tag.get_attribute("name")
 
 
    def __str__(self):
        result: str = "SOURCE: " + self.source + "\nURL: " + self.url + "\nEXPLOIT: " + self.payload

        if self.tag:
            result += \
                "\nTag Element: " + self.tag_element + \
                "\nTag ID: " + self.tag_id + \
                "\nTag Name: " + self.tag_name

        return result